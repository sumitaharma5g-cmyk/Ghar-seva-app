<button onclick="handlePayment()" class="w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-3 rounded-lg transition duration-300">
                            ‡§™‡•á‡§Æ‡•á‡§Ç‡§ü ‡§™‡•Ç‡§∞‡•Ä ‡§π‡•Å‡§à
                        </button>
                        
                        <button onclick="closePayment()" class="w-full bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-3 rounded-lg transition duration-300">
                            ‡§µ‡§æ‡§™‡§∏ ‡§ú‡§æ‡§è‡§Ç
                        </button>
                    </div>
                </div>
            </div>
        `;
    }

    function renderRequestSlip() {
        const req = state.requests.find(r => r.requestId === state.showSlip);
        if (!req) return '<p>Request not found</p>';
        const worker = state.workers.find(w => w.category === req.category && w.area === req.workerArea);
        return `
            <div class="min-h-screen bg-gray-100 p-4 flex items-center justify-center">
                <div class="bg-white max-w-2xl w-full rounded-xl shadow-2xl">
                    <div class="print-area">
                        <div class="bg-indigo-600 text-white p-6 text-center">
                            <h1 class="text-3xl font-bold mb-2">‡§ò‡§∞ ‡§∏‡•á‡§µ‡§æ ‡§ê‡§™</h1>
                            <p class="text-sm">Work Request Slip</p>
                        </div>
                        <div class="p-8">
                            <div class="text-center mb-6">
                                <div class="inline-block bg-yellow-100 px-4 py-2 rounded-lg">
                                    <p class="text-sm text-gray-600">Request ID</p>
                                    <p class="text-2xl font-bold text-gray-800">${req.requestId}</p>
                                </div>
                            </div>
                            <div class="grid md:grid-cols-2 gap-6 mb-6">
                                <div class="border-2 border-indigo-200 rounded-lg p-4">
                                    <h3 class="font-bold text-indigo-600 mb-3">üë§ Customer Details</h3>
                                    <p class="text-sm mb-1"><strong>Name:</strong> ${req.customerName}</p>
                                    <p class="text-sm mb-1"><strong>Phone:</strong> ${req.customerPhone}</p>
                                    <p class="text-sm"><strong>Area:</strong> ${req.area}</p>
                                </div>
                                ${worker ? `
                                    <div class="border-2 border-green-200 rounded-lg p-4">
                                        <h3 class="font-bold text-green-600 mb-3">üîß Worker Details</h3>
                                        <p class="text-sm mb-1"><strong>Name:</strong> ${worker.name}</p>
                                        <p class="text-sm mb-1"><strong>Phone:</strong> ${worker.phone}</p>
                                        <p class="text-sm"><strong>Category:</strong> ${worker.category}</p>
                                    </div>
                                ` : ''}
                            </div>
                            <div class="bg-gray-50 rounded-lg p-4 mb-6">
                                <h3 class="font-bold mb-3">üìã Work Details</h3>
                                <p class="text-sm mb-2"><strong>Category:</strong> ${req.category}</p>
                                <p class="text-sm mb-2"><strong>Description:</strong> ${req.description}</p>
                                <p class="text-sm"><strong>Date & Time:</strong> ${req.timestamp}</p>
                            </div>
                            <div class="bg-green-50 border-2 border-green-300 rounded-lg p-4 mb-6">
                                <div class="flex justify-between items-center">
                                    <span class="text-lg font-semibold">Estimated Price:</span>
                                    <span class="text-3xl font-bold text-green-600">‚Çπ${req.estimatedPrice}</span>
                                </div>
                                <p class="text-xs text-gray-500 mt-2">*Final price may vary based on work complexity</p>
                            </div>
                            ${req.photo ? `<div class="mb-4"><h3 class="font-bold mb-3">üì∑ Work Photo</h3><img src="${req.photo}" class="rounded-lg shadow-md max-w-full"></div>` : ''}
                            <div class="border-t pt-4 mt-6">
                                <p class="text-xs text-gray-500 text-center">This is a computer-generated slip. No signature required.<br>For support: support@gharseva.com</p>
                            </div>
                        </div>
                    </div>
                    <div class="bg-gray-100 p-4 flex gap-3 print:hidden">
                        <button onclick="window.print()" class="flex-1 bg-indigo-600 hover:bg-indigo-700 text-white py-3 rounded-lg font-semibold">üñ®Ô∏è Print Slip</button>
                        <button onclick="closeSlip()" class="flex-1 bg-gray-600 hover:bg-gray-700 text-white py-3 rounded-lg font-semibold">‚úï Close</button>
                    </div>
                </div>
            </div>
        `;
    }

    function renderPaymentScreen() {
        const worker = state.workers.find(w => w.id === state.showPayment.workerId);
        return `
            <div class="min-h-screen bg-gray-50 flex items-center justify-center p-4">
                <div class="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full">
                    <h2 class="text-2xl font-bold mb-6 text-center">üí≥ Payment</h2>
                    <div class="bg-indigo-50 rounded-lg p-4 mb-4">
                        <p class="font-medium text-lg">${worker.name}</p>
                        <p class="text-sm text-gray-600">${worker.category}</p>
                    </div>
                    <div class="mb-4">
                        <label class="block font-medium mb-2">Amount (‚Çπ)</label>
                        <input type="number" onchange="updatePaymentData('amount', this.value)" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500" placeholder="500">
                    </div>
                    <div class="bg-gray-50 p-4 rounded-lg mb-4 text-center">
                        <p class="text-sm mb-3 text-gray-600">Scan QR Code to Pay</p>
                        <img src="${generateQRCode(worker.upiId, worker.name, state.paymentData.amount)}" class="mx-auto rounded-lg shadow-md">
                        <p class="text-sm mt-3 text-gray-700">UPI ID: <strong>${worker.upiId}</strong></p>
                    </div>
                    <button onclick="handlePayment()" class="w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-3 rounded-lg mb-3">Payment Done</button>
                    <button onclick="closePayment()" class="w-full bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-3 rounded-lg">Back</button>
                </div>
            </div>
        `;
    }

    function renderFeedbackScreen() {
        return `
            <div class="min-h-screen bg-gray-50 flex items-center justify-center p-4">
                <div class="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full">
                    <h2 class="text-2xl font-bold mb-6 text-center">‚≠ê Feedback</h2>
                    <p class="text-center font-medium text-lg mb-6">${state.showFeedback.workerName}</p>
                    <div class="mb-6">
                        <label class="block font-medium mb-3 text-center">Rating ‡§¶‡•á‡§Ç</label>
                        <div class="flex justify-center gap-2">
                            ${[1,2,3,4,5].map(s => `
                                <button onclick="setRating(${s})" class="star text-5xl ${s <= state.feedbackData.rating ? 'text-yellow-400' : 'text-gray-300'}">‚òÖ</button>
                            `).join('')}
                        </div>
                    </div>
                    <div class="mb-6">
                        <label class="block font-medium mb-2">Comment (‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï)</label>
                        <textarea onchange="updateFeedbackData('comment', this.value)" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500" rows="4" placeholder="‡§Ö‡§™‡§®‡§æ ‡§Ö‡§®‡•Å‡§≠‡§µ ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç..."></textarea>
                    </div>
                    <button onclick="submitFeedback()" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 rounded-lg mb-3">Submit Feedback</button>
                    <button onclick="closeFeedback()" class="w-full bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-3 rounded-lg">‡§¨‡§æ‡§¶ ‡§Æ‡•á‡§Ç</button>
                </div>
            </div>
        `;
    }

    function selectUserType(type) { state.userType = type; render(); }
    function resetUserType() { 
        state.userType = null; 
        state.adminLogin = { phone: '', otp: '', otpSent: false }; 
        generatedOTP = null;
        render(); 
    }
    function updateFormData(field, value) { state.formData[field] = value; }
    function updateAdminLogin(field, value) { state.adminLogin[field] = value; }
    
    function sendOTP() {
        if (state.adminLogin.phone !== ADMIN_PHONE) {
            alert('‚ùå Unauthorized access! Invalid phone number.');
            return;
        }
        generatedOTP = Math.floor(1000 + Math.random() * 9000).toString();
        otpGeneratedTime = Date.now();
        state.adminLogin.otpSent = true;
        
        // Real app me SMS API se OTP jayega
        // Console me dekh sakte ho (F12 > Console)
        console.log('Admin OTP:', generatedOTP);
        
        // Alert me bhi dikha rahe testing ke liye
        alert('‚úÖ OTP sent successfully!\n\nüîê Your OTP: ' + generatedOTP + '\n\n(Production ‡§Æ‡•á‡§Ç ‡§Ø‡§π SMS ‡§∏‡•á ‡§Ü‡§è‡§ó‡§æ)');
        
        render();
    }
    
    function verifyOTP() {
        if (!state.adminLogin.otp) {
            alert('‡§ï‡•É‡§™‡§Ø‡§æ OTP enter ‡§ï‡§∞‡•á‡§Ç');
            return;
        }
        
        const otpAge = (Date.now() - otpGeneratedTime) / 1000 / 60;
        if (otpAge > 5) {
            alert('‚è±Ô∏è OTP expired! Please request a new OTP.');
            state.adminLogin.otpSent = false;
            generatedOTP = null;
            render();
            return;
        }
        
        if (state.adminLogin.otp === generatedOTP) {
            state.isAdmin = true;
            state.isLoggedIn = true;
            state.currentUser = { name: 'Admin', phone: ADMIN_PHONE };
            state.adminLogin = { phone: '', otp: '', otpSent: false };
            generatedOTP = null;
            alert('‚úÖ Welcome Admin! Login successful.');
            render();
        } else {
            alert('‚ùå Invalid OTP! Please try again.');
        }
    }

    function handleRegister() {
        if (!state.formData.name || !state.formData.phone || !state.formData.area) {
            return alert('‡§ï‡•É‡§™‡§Ø‡§æ ‡§∏‡§≠‡•Ä ‡§ú‡§∞‡•Ç‡§∞‡•Ä fields ‡§≠‡§∞‡•á‡§Ç');
        }
        if (state.userType === 'worker') {
            if (!state.formData.category || !state.formData.upiId) return alert('‡§ï‡•É‡§™‡§Ø‡§æ ‡§∏‡§≠‡•Ä fields ‡§≠‡§∞‡•á‡§Ç (UPI ID ‡§ú‡§∞‡•Ç‡§∞‡•Ä ‡§π‡•à)');
            state.currentUser = { 
                id: Date.now(), 
                ...state.formData, 
                rating: 0, 
                totalReviews: 0, 
                reviews: [],
                verified: false
            };
            state.workers.push(state.currentUser);
            alert('‚úÖ ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•á‡§∂‡§® ‡§∏‡§´‡§≤! Admin approval pending.');
        } else {
            state.currentUser = { id: Date.now(), name: state.formData.name, phone: state.formData.phone, area: state.formData.area };
            state.customers.push(state.currentUser);
        }
        state.isLoggedIn = true;
        state.formData = { name: '', phone: '', category: '', experience: '', area: '', upiId: '' };
        render();
    }

    function selectCategory(cat, price) { 
        state.requestData.category = cat; 
        state.requestData.estimatedPrice = price;
        render(); 
    }

    function updateRequestData(field, value) { state.requestData[field] = value; render(); }

    function handleImageUpload(e) {
        const file = e.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onloadend = () => { state.requestData.photo = reader.result; render(); };
            reader.readAsDataURL(file);
        }
    }

    function handleRequest() {
        if (!state.requestData.category || !state.requestData.description || !state.requestData.area) {
            return alert('‡§ï‡•É‡§™‡§Ø‡§æ ‡§ï‡•à‡§ü‡•á‡§ó‡§∞‡•Ä, area ‡§î‡§∞ ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§≠‡§∞‡•á‡§Ç');
        }
        const requestId = generateRequestId();
        const newRequest = {
            id: Date.now(),
            requestId: requestId,
            customerId: state.currentUser.id,
            customerName: state.currentUser.name,
            customerPhone: state.currentUser.phone,
            ...state.requestData,
            workerArea: state.requestData.area,
            timestamp: new Date().toLocaleString('hi-IN'),
            status: 'pending'
        };
        state.requests.push(newRequest);
        state.showSlip = requestId;
        render();
    }

    function viewSlip(requestId) { state.showSlip = requestId; render(); }
    function closeSlip() { 
        state.showSlip = null; 
        state.requestData = { category: '', description: '', photo: null, area: '', estimatedPrice: '' };
        render(); 
    }

    function showPaymentScreen(id, name) { state.showPayment = { workerId: id, workerName: name }; render(); }
    function closePayment() { state.showPayment = null; render(); }
    function updatePaymentData(field, value) { state.paymentData[field] = value; render(); }
    
    function handlePayment() {
        if (!state.paymentData.amount) return alert('‡§ï‡•É‡§™‡§Ø‡§æ ‡§∞‡§æ‡§∂‡§ø ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç');
        state.showFeedback = { 
            workerId: state.showPayment.workerId, 
            workerName: state.showPayment.workerName, 
            amount: state.paymentData.amount 
        };
        state.showPayment = null;
        render();
    }

    function setRating(r) { state.feedbackData.rating = r; render(); }
    function updateFeedbackData(field, value) { state.feedbackData[field] = value; }
    
    function submitFeedback() {
        if (!state.feedbackData.rating) return alert('‡§ï‡•É‡§™‡§Ø‡§æ ‡§∞‡•á‡§ü‡§ø‡§Ç‡§ó ‡§¶‡•á‡§Ç');
        const idx = state.workers.findIndex(w => w.id === state.showFeedback.workerId);
        if (idx !== -1) {
            const review = { 
                id: Date.now(), 
                customerName: state.currentUser.name, 
                rating: state.feedbackData.rating, 
                comment: state.feedbackData.comment, 
                timestamp: new Date().toLocaleString('hi-IN') 
            };
            state.workers[idx].reviews.push(review);
            state.workers[idx].rating = state.workers[idx].reviews.reduce((a,r) => a + r.rating, 0) / state.workers[idx].reviews.length;
            state.workers[idx].totalReviews = state.workers[idx].reviews.length;
        }
        alert('‚úÖ ‡§´‡•Ä‡§°‡§¨‡•à‡§ï ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï submit ‡§π‡•ã ‡§ó‡§Ø‡§æ!');
        state.showFeedback = null;
        state.feedbackData = { rating: 0, comment: '' };
        render();
    }

    function closeFeedback() { state.showFeedback = null; render(); }
    
    function approveWorker(id) {
        const idx = state.workers.findIndex(w => w.id === id);
        if (idx !== -1) {
            state.workers[idx].verified = true;
            alert('‚úÖ Worker approved successfully!');
            render();
        }
    }

    function deleteWorker(id) {
        if (confirm('Are you sure you want to delete this worker?')) {
            state.workers = state.workers.filter(w => w.id !== id);
            alert('‚úÖ Worker deleted successfully!');
            render();
        }
    }

    function logout() { 
        state.isLoggedIn = false; 
        state.userType = null; 
        state.currentUser = null;
        state.isAdmin = false;
        state.requestData = { category: '', description: '', photo: null, area: '', estimatedPrice: '' };
        render(); 
    }

    render();
</script>
</body>
</html>
    }

    function renderFeedbackScreen() {
        return `
            <div class="min-h-screen bg-gray-50 flex items-center justify-center p-4">
                <div class="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">‡§´‡•Ä‡§°‡§¨‡•à‡§ï ‡§¶‡•á‡§Ç</h2>
                    
                    <div class="text-center mb-6">
                        <p class="text-gray-700 font-medium mb-2">${state.showFeedback.workerName}</p>
                        ${state.showFeedback.amount ? `<p class="text-sm text-green-600">‡§™‡•á‡§Æ‡•á‡§Ç‡§ü: ‚Çπ${state.showFeedback.amount}</p>` : ''}
                    </div>

                    <div class="mb-6">
                        <label class="block text-gray-700 font-medium mb-3 text-center">‡§∞‡•á‡§ü‡§ø‡§Ç‡§ó ‡§¶‡•á‡§Ç</label>
                        <div class="flex justify-center gap-2">
                            ${[1, 2, 3, 4, 5].map(star => `
                                <button onclick="setRating(${star})" class="star transition duration-200">
                                    <span class="text-4xl ${star <= state.feedbackData.rating ? 'text-yellow-400' : 'text-gray-300'}">‚òÖ</span>
                                </button>
                            `).join('')}
                        </div>
                    </div>

                    <div class="mb-6">
                        <label class="block text-gray-700 font-medium mb-2">‡§ï‡§Æ‡•á‡§Ç‡§ü (‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï)</label>
                        <textarea id="feedbackComment" onchange="updateFeedbackData('comment', this.value)" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500" rows="4" placeholder="‡§Ö‡§™‡§®‡§æ ‡§Ö‡§®‡•Å‡§≠‡§µ ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç...">${state.feedbackData.comment}</textarea>
                    </div>

                    <div class="space-y-3">
                        <button onclick="submitFeedback()" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 rounded-lg transition duration-300">
                            ‡§´‡•Ä‡§°‡§¨‡•à‡§ï ‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§ï‡§∞‡•á‡§Ç
                        </button>
                        
                        <button onclick="closeFeedback()" class="w-full bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-3 rounded-lg transition duration-300">
                            ‡§¨‡§æ‡§¶ ‡§Æ‡•á‡§Ç
                        </button>
                    </div>
                </div>
            </div>
        `;
    }

    // Event Handlers
    function selectUserType(type) {
        state.userType = type;
        render();
    }

    function resetUserType() {
        state.userType = null;
        state.formData = { name: '', phone: '', category: '', experience: '', area: '', upiId: '' };
        render();
    }

    function updateFormData(field, value) {
        state.formData[field] = value;
    }

    function handleRegister() {
        if (!state.formData.name || !state.formData.phone) {
            alert('‡§ï‡•É‡§™‡§Ø‡§æ ‡§∏‡§≠‡•Ä ‡§ú‡§∞‡•Ç‡§∞‡•Ä ‡§´‡•Ä‡§≤‡•ç‡§° ‡§≠‡§∞‡•á‡§Ç');
            return;
        }

        if (state.userType === 'worker') {
            if (!state.formData.category || !state.formData.experience || !state.formData.area || !state.formData.upiId) {
                alert('‡§ï‡•É‡§™‡§Ø‡§æ ‡§∏‡§≠‡•Ä ‡§ú‡§∞‡•Ç‡§∞‡•Ä ‡§´‡•Ä‡§≤‡•ç‡§° ‡§≠‡§∞‡•á‡§Ç (UPI ID ‡§ú‡§∞‡•Ç‡§∞‡•Ä ‡§π‡•à)');
                return;
            }
            const newWorker = {
                id: Date.now(),
                ...state.formData,
                rating: 0,
                totalReviews: 0,
                reviews: []
            };
            state.workers.push(newWorker);
            state.currentUser = newWorker;
        } else {
            state.currentUser = {
                id: Date.now(),
                name: state.formData.name,
                phone: state.formData.phone,
                type: 'customer'
            };
        }
        state.isLoggedIn = true;
        state.formData = { name: '', phone: '', category: '', experience: '', area: '', upiId: '' };
        render();
    }

    function selectCategory(category) {
        state.requestData.category = category;
        render();
    }

    function updateRequestData(field, value) {
        state.requestData[field] = value;
    }

    function handleImageUpload(event) {
        const file = event.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onloadend = () => {
                state.requestData.photo = reader.result;
                render();
            };
            reader.readAsDataURL(file);
        }
    }

    function handleRequest() {
        if (!state.requestData.category || !state.requestData.description) {
            alert('‡§ï‡•É‡§™‡§Ø‡§æ ‡§ï‡•à‡§ü‡•á‡§ó‡§∞‡•Ä ‡§î‡§∞ ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§≠‡§∞‡•á‡§Ç');
            return;
        }

        const newRequest = {
            id: Date.now(),
            customerId: state.currentUser.id,
            customerName: state.currentUser.name,
            customerPhone: state.currentUser.phone,
            ...state.requestData,
            timestamp: new Date().toLocaleString('hi-IN'),
            status: 'pending'
        };
        state.requests.push(newRequest);
        alert('‡§Ü‡§™‡§ï‡§æ ‡§∞‡§ø‡§ï‡•ç‡§µ‡•á‡§∏‡•ç‡§ü ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§≠‡•á‡§ú ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à!');
        state.requestData = { category: '', description: '', photo: null };
        render();
    }

    function showPaymentScreen(workerId, workerName) {
        state.showPayment = { workerId, workerName };
        render();
    }

    function closePayment() {
        state.showPayment = null;
        state.paymentData = { amount: '', transactionId: '' };
        render();
    }

    function updatePaymentData(field, value) {
        state.paymentData[field] = value;
        // Update QR code dynamically
        if (field === 'amount') {
            render();
        }
    }

    function handlePayment() {
        if (!state.paymentData.amount || state.paymentData.amount <= 0) {
            alert('‡§ï‡•É‡§™‡§Ø‡§æ ‡§∏‡§π‡•Ä ‡§∞‡§æ‡§∂‡§ø ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç');
            return;
        }

        alert('‡§™‡•á‡§Æ‡•á‡§Ç‡§ü ‡§™‡•Ç‡§∞‡•Ä ‡§π‡•ã ‡§ó‡§à! ‡§Ö‡§¨ ‡§´‡•Ä‡§°‡§¨‡•à‡§ï ‡§¶‡•á‡§Ç‡•§');
        state.showFeedback = {
            workerId: state.showPayment.workerId,
            workerName: state.showPayment.workerName,
            amount: state.paymentData.amount
        };
        state.showPayment = null;
        state.paymentData = { amount: '', transactionId: '' };
        render();
    }

    function setRating(rating) {
        state.feedbackData.rating = rating;
        render();
    }

    function updateFeedbackData(field, value) {
        state.feedbackData[field] = value;
    }

    function submitFeedback() {
        if (state.feedbackData.rating === 0) {
            alert('‡§ï‡•É‡§™‡§Ø‡§æ ‡§∞‡•á‡§ü‡§ø‡§Ç‡§ó ‡§¶‡•á‡§Ç');
            return;
        }

        const workerIndex = state.workers.findIndex(w => w.id === state.showFeedback.workerId);
        if (workerIndex !== -1) {
            const newReview = {
                id: Date.now(),
                customerId: state.currentUser.id,
                customerName: state.currentUser.name,
                rating: state.feedbackData.rating,
                comment: state.feedbackData.comment,
                timestamp: new Date().toLocaleString('hi-IN')
            };
            
            state.workers[workerIndex].reviews.push(newReview);
            const reviews = state.workers[workerIndex].reviews;
            const avgRating = reviews.reduce((acc, r) => acc + r.rating, 0) / reviews.length;
            state.workers[workerIndex].rating = avgRating;
            state.workers[workerIndex].totalReviews = reviews.length;
        }

        alert('‡§Ü‡§™‡§ï‡§æ ‡§´‡•Ä‡§°‡§¨‡•à‡§ï ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§π‡•ã ‡§ó‡§Ø‡§æ!');
        state.showFeedback = null;
        state.feedbackData = { rating: 0, comment: '' };
        render();
    }

    function closeFeedback() {
        state.showFeedback = null;
        state.feedbackData = { rating: 0, comment: '' };
        render();
    }

    function logout() {
        state.isLoggedIn = false;
        state.userType = null;
        state.currentUser = null;
        state.requestData = { category: '', description: '', photo: null };
        render();
    }

    // Initial render
    render();
</script>

</body>
</html>
